<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: models/Teams/imports/components/TeamPanel.jsx</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: models/Teams/imports/components/TeamPanel.jsx</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @author          Leo Keith &lt;leo@fmclarity.com>
 * @copyright       2016 FM Clarity Pty Ltd.
 */

import React from "react";
import { ReactMeteorData } from 'meteor/react-meteor-data';

import { Teams } from '/modules/models/Teams';
import { Menu } from '/modules/ui/MaterialNavigation';
import TeamActions from '../../actions.jsx';
import { ServicesProvidedEditor } from '/modules/mixins/Services';

import { ContactList } from '/modules/mixins/Members';
import { AutoForm } from '/modules/core/AutoForm';
import { Tabs } from '/modules/ui/Tabs';


function addTeamMenuItem( menu, item, team ) {
	if ( team ) {
		if ( /*team.hasSupplier( item ) &amp;&amp; team.canRemoveSupplier &amp;&amp; team.canRemoveSupplier() &amp;&amp; team._id != item._id*/ true ) {

			menu.push( {
				label: "Remove supplier from " + team.name,
				shouldConfirm: true,
				action() {
					team.removeSupplier( item );
					Modal.hide();
				}
			} );

		}

		if ( item &amp;&amp; item.ownerIs &amp;&amp; item.ownerIs( team ) ) {
			var itemName = item.name;
			menu.push( {
				label: "Revoke ownership of " + itemName,
				shouldConfirm: true,
				action() {
					item.clearOwner();
				}
			} )
		}
	}
}

/**
 * @class 			TeamPanel
 * @memberOf 		module:models/Teams
 */
const TeamPanel = React.createClass( {

	mixins: [ ReactMeteorData ],

	getMeteorData() {
		var team, services, insuranceDocs;
		Meteor.subscribe( 'contractors' );
		Meteor.subscribe( 'teamsAndFacilitiesForUser' );
		team = this.props.item;
		//console.log( team );
		if ( team ) {
			Meteor.subscribe( "messages", "Teams", team._id, moment().subtract( { days: 7 } ).toDate() );
			services = team.getAvailableServices();
			insuranceDocs = team.getDocs( {
				type: "Insurance"
			} );
		}
		return {
			services: services,
			insuranceDocs: insuranceDocs
		}
	},

	getMenu() {
		return [ TeamActions.edit.bind( this.props.item ) ];
	},

	render() {
		let team = this.props.item;
		if ( !team ) {
			return &lt;div/>
		}

		let insuranceDocs = this.data.insuranceDocs,
			availableServices = this.data.services,
			contactName = team.contact ? team.contact.name : null;

		let insuranceExpiry;
		if ( insuranceDocs &amp;&amp; insuranceDocs.length ) {
			let primaryDoc = insuranceDocs[ 0 ];
			if ( primaryDoc.expiryDate != null ) {
				insuranceExpiry = moment( primaryDoc.expiryDate )
					.format( 'DD/MM/YYYY' );
			}
		}

		return (
			&lt;div>
			{/*this should be in sub-component*/}
			&lt;div className="business-card">{/*should perhaps be team-card?*/}
				&lt;div className="contact-thumbnail pull-left">
					{team.thumbUrl?
						&lt;img alt="image" src={team.thumbUrl} />
					:null}
				 &lt;/div>
				 &lt;div className="contact-info">

					&lt;h2>{team.name}&lt;/h2>

					&lt;i style={{color:"#999",display:"block",padding:"3px"}}>{ contactName ? contactName : null }&lt;br/>&lt;/i>
					&lt;b>Email&lt;/b> { team.email }&lt;br/>
					{ team.phone ? &lt;span>&lt;b>Phone&lt;/b> { team.phone }&lt;br/>&lt;/span> :null }
					{ team.phone2 ? &lt;span>&lt;b>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/b> { team.phone2 }&lt;br/>&lt;/span> :null }
					{ insuranceExpiry ? &lt;span>&lt;b>Insurance Expiry&lt;/b> { insuranceExpiry }&lt;/span> :null }
					&lt;div style={{margin:"10px 0 10px 70px",borderBottom:"1px solid #ccc"}}>&lt;/div>

					{/*this should def be own component*/availableServices &amp;&amp; availableServices.length?

					availableServices.map( (service,index) => {
						return &lt;span key = { service.name }>{ index?' | ':'' }{ service.name }&lt;/span>
					})

					:null}
				&lt;/div>
			&lt;/div>

			&lt;Tabs tabs={[
				{
					//hide: 		!team.canGetMessages(),
					tab: 		&lt;span id = "discussion-tab">&lt;span style = {{color:"black"}}>Updates&lt;/span>&lt;/span>,
					content: 	&lt;Inbox for = { team } readOnly = { true } truncate = { true }/>
				},{
					//hide: 		!team.canAddDocument(),
					tab: 		&lt;span id = "documents-tab">&lt;span style = {{color:"black"}}>Documents&lt;/span>&lt;/span>,
					content: 	&lt;AutoForm model = { Teams } item = { team } form = { ["documents"] }/>
				},{
					//hide: 		!team.canAddMember(),
					tab: 		&lt;span id="personnel-tab">&lt;span style={{color:"black"}}>Personnel&lt;/span>&lt;/span>,
					content: 	&lt;ContactList group = { team } team = { team }/>
				},{
					//hide: 		!team.canSetServicesProvided(),
					tab: 		&lt;span id="services-tab">&lt;span style={{color:"black"}}>Services&lt;/span>&lt;/span>,
					content: 	&lt;ServicesProvidedEditor item = { team } save = { team.setServicesProvided.bind(team) }/>
				}
			]}/> 
			
			&lt;Menu items = { this.getMenu() } />

		&lt;/div>
		)
	}
} );

export default TeamPanel;</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-core.html">core</a></li><li><a href="module-core_Actions.html">core/Actions</a></li><li><a href="module-core_Authentication.html">core/Authentication</a></li><li><a href="module-core_AutoForm.html">core/AutoForm</a></li><li><a href="module-core_Layouts.html">core/Layouts</a></li><li><a href="module-core_ORM.html">core/ORM</a></li><li><a href="module-features.html">features</a></li><li><a href="module-features_Admin.html">features/Admin</a></li><li><a href="module-features_Compliance.html">features/Compliance</a></li><li><a href="module-features_Reports.html">features/Reports</a></li><li><a href="module-mixins.html">mixins</a></li><li><a href="module-mixins_Areas.html">mixins/Areas</a></li><li><a href="module-mixins_Members.html">mixins/Members</a></li><li><a href="module-mixins_Owners.html">mixins/Owners</a></li><li><a href="module-mixins_Roles.html">mixins/Roles</a></li><li><a href="module-mixins_Services.html">mixins/Services</a></li><li><a href="module-mixins_Thumbs.html">mixins/Thumbs</a></li><li><a href="module-models.html">models</a></li><li><a href="module-models_Documents.html">models/Documents</a></li><li><a href="module-models_Facilities.html">models/Facilities</a></li><li><a href="module-models_Files.html">models/Files</a></li><li><a href="module-models_Messages.html">models/Messages</a></li><li><a href="module-models_Notifications.html">models/Notifications</a></li><li><a href="module-models_Requests.html">models/Requests</a></li><li><a href="module-models_Teams.html">models/Teams</a></li><li><a href="module-models_Users.html">models/Users</a></li><li><a href="module-ui.html">ui</a></li><li><a href="module-ui_Calendar.html">ui/Calendar</a></li><li><a href="module-ui_DataTable.html">ui/DataTable</a></li><li><a href="module-ui_MaterialInputs.html">ui/MaterialInputs</a></li><li><a href="module-ui_MaterialMisc.html">ui/MaterialMisc</a></li><li><a href="module-ui_MaterialNavigation.html">ui/MaterialNavigation</a></li><li><a href="module-ui_MaterialViews.html">ui/MaterialViews</a></li><li><a href="module-ui_Modal.html">ui/Modal</a></li><li><a href="module-ui_Stepper.html">ui/Stepper</a></li><li><a href="module-ui_Tabs.html">ui/Tabs</a></li></ul><h3>Classes</h3><ul><li><a href="module-core_Actions.Action.html">Action</a></li><li><a href="module-core_Actions.ActionGroup.html">ActionGroup</a></li><li><a href="module-core_Actions.Route.html">Route</a></li><li><a href="module-core_Actions.RouteGroup.html">RouteGroup</a></li><li><a href="module-core_Authentication.LoginService.html">LoginService</a></li><li><a href="module-core_Authentication.Page403.html">Page403</a></li><li><a href="module-core_Authentication.PageChangePassword.html">PageChangePassword</a></li><li><a href="module-core_Authentication.PageLogin.html">PageLogin</a></li><li><a href="module-core_Authentication.PageLostPassword.html">PageLostPassword</a></li><li><a href="module-core_Authentication.PageNotFound.html">PageNotFound</a></li><li><a href="module-core_Authentication.PageRegister.html">PageRegister</a></li><li><a href="module-core_AutoForm.AutoForm.html">AutoForm</a></li><li><a href="module-core_AutoForm.FormController.html">FormController</a></li><li><a href="module-core_Layouts.FloatingActionButtonContainer.html">FloatingActionButtonContainer</a></li><li><a href="module-core_Layouts.LayoutBlank.html">LayoutBlank</a></li><li><a href="module-core_Layouts.LayoutMain.html">LayoutMain</a></li><li><a href="module-core_Layouts.LayoutPrint.html">LayoutPrint</a></li><li><a href="module-core_Layouts.LayoutWide.html">LayoutWide</a></li><li><a href="module-core_Layouts.NavigationDrawerContainer.html">NavigationDrawerContainer</a></li><li><a href="module-core_Layouts.TopNavigationBarContainer.html">TopNavigationBarContainer</a></li><li><a href="module-core_ORM.Model.html">Model</a></li><li><a href="module-core_ORM.ValidatedMethod.html">ValidatedMethod</a></li><li><a href="module-features_Admin.AdminPageIndex.html">AdminPageIndex</a></li><li><a href="module-features_Compliance.CompliancePageIndex.html">CompliancePageIndex</a></li><li><a href="module-features_Compliance.CompliancePageIndexContainer.html">CompliancePageIndexContainer</a></li><li><a href="module-features_Reports.PageDashboard.html">PageDashboard</a></li><li><a href="module-features_Reports.PageDashboardContainer.html">PageDashboardContainer</a></li><li><a href="module-mixins_Areas.AreasEditor.html">AreasEditor</a></li><li><a href="module-mixins_Services.ServicesProvidedEditor.html">ServicesProvidedEditor</a></li><li><a href="module-mixins_Services.ServicesProvidedEditorRow.html">ServicesProvidedEditorRow</a></li><li><a href="module-mixins_Services.ServicesRequiredEditor.html">ServicesRequiredEditor</a></li><li><a href="module-mixins_Services.ServicesRequiredEditorRow.html">ServicesRequiredEditorRow</a></li><li><a href="module-models_Facilities.FacilityFilter.html">FacilityFilter</a></li><li><a href="module-models_Facilities.FacilityListTile.html">FacilityListTile</a></li><li><a href="module-models_Facilities.FacilityPanel.html">FacilityPanel</a></li><li><a href="module-models_Files.FileExplorer.html">FileExplorer</a></li><li><a href="module-models_Files.FilesPageIndex.html">FilesPageIndex</a></li><li><a href="module-models_Files.FileView.html">FileView</a></li><li><a href="module-models_Files.FileViewEdit.html">FileViewEdit</a></li><li><a href="module-models_Requests.RequestsPageIndex.html">RequestsPageIndex</a></li><li><a href="module-models_Teams.TeamPageSuppliers.html">TeamPageSuppliers</a></li><li><a href="module-models_Teams.TeamPageSuppliersContainer.html">TeamPageSuppliersContainer</a></li><li><a href="module-models_Teams.TeamPanel.html">TeamPanel</a></li><li><a href="module-models_Users.UserPageProfileContainer.html">UserPageProfileContainer</a></li><li><a href="module-models_Users.UsersPageIndex.html">UsersPageIndex</a></li><li><a href="module-ui_Calendar.CalendarPage.html">CalendarPage</a></li><li><a href="module-ui_MaterialInputs.DateInput.html">DateInput</a></li><li><a href="module-ui_MaterialInputs.DateTime.html">DateTime</a></li><li><a href="module-ui_MaterialInputs.FileField.html">FileField</a></li><li><a href="module-ui_MaterialInputs.PlainCard.html">PlainCard</a></li><li><a href="module-ui_MaterialInputs.Rating.html">Rating</a></li><li><a href="module-ui_MaterialInputs.Select.html">Select</a></li><li><a href="module-ui_MaterialInputs.Switch.html">Switch</a></li><li><a href="module-ui_MaterialInputs.Text.html">Text</a></li><li><a href="module-ui_MaterialInputs.TextArea.html">TextArea</a></li><li><a href="module-ui_MaterialNavigation.NavListDropDown.html">NavListDropDown</a></li><li><a href="module-ui_MaterialNavigation.NavListTileMultiple.html">NavListTileMultiple</a></li><li><a href="module-ui_MaterialViews.ListTile.html">ListTile</a></li><li><a href="module-ui_MaterialViews.Thumbnail.html">Thumbnail</a></li><li><a href="UserPanel.html">UserPanel</a></li></ul><h3>Global</h3><ul><li><a href="global.html#Elastic">Elastic</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Thu Sep 22 2016 23:17:32 GMT+1000 (E. Australia Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
